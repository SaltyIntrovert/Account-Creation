#Part 1
param($email,$empID,$userID,$eA10,$Groups,$NAMEfull,$OU)
    $email=Get-ADUser -Filter {employeeID -eq "%empID%"} | Select-Object -ExpandProperty userPrincipalName
    $userID=Get-ADUser -Filter {employeeID -eq "%empID%"} | Select-Object -ExpandProperty SamAccountName
        $eA10=Get-ADUser $userID -Properties * | Select-Object -ExpandProperty extensionAttribute10
        $Groups=(Get-ADPrincipalGroupMembership -Identity $userID | Select-Object -ExpandProperty SAMAccountName) -ne 'Domain Users'
        $jobTitle=Get-ADUser $userID -Properties * | Select-Object -expandProperty title
        $NAMEfull=Get-ADUser -Filter {SamAccountName -eq $userID} | Select-Object -ExpandProperty Name
        $OU= Get-ADUser $userID -Properties * | Select-Object -ExpandProperty distinguishedName 
   
IF($OU -ne "$NAMEfull*******"){
    Disable-ADAccount -Identity $userID
    Get-ADUser $userID | Move-ADObject -TargetPath "*******"
}else{}
IF($Groups -eq ''){}else{Remove-ADPrincipalGroupMembership -Identity $userID -MemberOf $Groups -Confirm:$false}
Set-ADUser -Identity $userID -clear facsimileTelephoneNumber,homePhone,ipPhone,telephoneNumber,initials

#Create JSON
$JSON=[pscustomobject]@{
    eagleID=$eA10
    email=$email
    jobTitle=$jobTitle
}
$JSON | ConvertTo-Json -Compress | Write-Output


#Part 2
$userID=Get-ADUser -Filter {employeeID -eq "%empID%"} | Select-Object -ExpandProperty SamAccountName
$Date='%termDate%' -split 'T00:00:00'
    Set-ADUser $userID -Clear extensionAttribute10
    Set-ADuser $userID -Description "Terminated $Date"
